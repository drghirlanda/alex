#!/usr/bin/pebl-language

define Start( par ) {

  # Installation folder:
  #gAlexDir <- "/usr/share/alex/Library/Init/"
  gAlexDir <- "Library/Init/"

  # Experiment name:
  gExpDir <- Nth(par, 1)
  if( IsDirectory( gExpDir ) ) {
    SignalFatalError( "Folder "+gExpDir+" already exists, stopping" )
  } 
  gExpDir <- gExpDir + "/"

  Print( "Creating experiment in " + gExpDir )
  MakeDirectory( gExpDir )
  loop( f, GetDirectoryListing( gAlexDir ) ) {
    MakeDirectory( gExpDir + f )
  }

  loop( f, GetDirectoryListing( gAlexDir + "Design" ) ) {
    if( f != "." and f != ".." ) {
      source <- gAlexDir + "Design/" + f
      destination <- gExpDir + "Design/" + f
      AppendFile( destination, source )
    }
  }

  loop( f, GetDirectoryListing( gAlexDir + "Materials" ) ) {
    if( f != "." and f != ".." ) {
      source <- gAlexDir + "Materials/" + f
      destination <- gExpDir + "Materials/" + f
      AppendFile( destination, source )
    }
  }
}